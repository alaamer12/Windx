# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# Application name displayed in API documentation
APP_NAME="Backend API"

# Application version
APP_VERSION="1.0.0"

# Debug mode (True for development, False for production)
# Enables detailed error messages and SQL query logging
DEBUG=True

# API version 1 route prefix
API_V1_PREFIX="/api/v1"


# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Database provider: "supabase" or "postgresql"
# - supabase: Use Supabase hosted PostgreSQL (recommended for development)
# - postgresql: Use self-hosted PostgreSQL (recommended for production)
DATABASE_PROVIDER=supabase

# Connection mode for Supabase (ignored for postgresql provider)
# - transaction_pooler: Recommended, uses port 6543 (does not support PREPARE statements)
# - session_pooler: Uses port 5432, supports all PostgreSQL features
# - direct: Direct connection, requires IPv6 support
DATABASE_CONNECTION_MODE=transaction_pooler

# Database host
# For Supabase transaction pooler: aws-0-eu-west-3.pooler.supabase.com
# For Supabase session pooler: aws-0-eu-west-3.pooler.supabase.com
# For Supabase direct: db.xxxxx.supabase.co
# For PostgreSQL: localhost or your server IP
DATABASE_HOST=aws-0-eu-west-3.pooler.supabase.com

# Database port
# For Supabase transaction pooler: 6543
# For Supabase session pooler: 5432
# For Supabase direct: 5432
# For PostgreSQL: 5432 (default)
DATABASE_PORT=6543

# Database user
# For Supabase pooler: postgres.your-project-ref
# For Supabase direct: postgres
# For PostgreSQL: your database user
DATABASE_USER=postgres.xxxxx

# Database password
# How to get: Supabase Dashboard → Settings → Database → Database Password
DATABASE_PASSWORD=your_database_password_here

# Database name (usually "postgres" for Supabase)
DATABASE_NAME=postgres

# Connection pool size (number of connections to maintain)
# Supabase: Keep low (3-5) due to connection limits
# PostgreSQL: Can be higher (10-20)
DATABASE_POOL_SIZE=5

# Maximum overflow connections beyond pool_size
DATABASE_MAX_OVERFLOW=10

# Enable connection health checks before using
# Recommended: True (especially for Supabase)
DATABASE_POOL_PRE_PING=True

# Echo SQL queries to console (useful for debugging)
# Set to True in development, False in production
DATABASE_ECHO=False

# Disable transaction pooler warning message
# Set to True to suppress the PREPARE statement warning
DATABASE_DISABLE_POOLER_WARNING=False


# =============================================================================
# SUPABASE CONFIGURATION (Optional - for Supabase client features)
# =============================================================================

# Supabase project URL
# How to get: Supabase Dashboard → Settings → API → Project URL
SUPABASE_URL=https://xxxxx.supabase.co

# Supabase anonymous/public API key
# How to get: Supabase Dashboard → Settings → API → Project API keys → anon public
SUPABASE_ANON_KEY=your_supabase_anon_key_here

# Supabase service role key (keep secret!)
# How to get: Supabase Dashboard → Settings → API → Project API keys → service_role
# WARNING: Never expose this key in client-side code!
# SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key_here


# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Secret key for JWT token generation
# IMPORTANT: Change this in production! Must be at least 32 characters
# Generate with: openssl rand -hex 32
SECRET_KEY="dev-secret-key-change-in-production-min-32-characters-long"

# JWT algorithm (HS256 is recommended)
ALGORITHM="HS256"

# Access token expiration time in minutes
ACCESS_TOKEN_EXPIRE_MINUTES=30


# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# Allowed CORS origins (comma-separated or JSON array)
# Add your frontend URLs here
BACKEND_CORS_ORIGINS=["http://localhost:3000","http://localhost:8000","http://127.0.0.1:3000","http://127.0.0.1:8000"]


# =============================================================================
# CACHE CONFIGURATION (Redis)
# =============================================================================

# Enable caching (requires Redis)
CACHE_ENABLED=False

# Redis host
CACHE_REDIS_HOST=localhost

# Redis port
CACHE_REDIS_PORT=6379

# Redis password (leave empty if no password)
CACHE_REDIS_PASSWORD=

# Redis database number (0-15)
CACHE_REDIS_DB=0

# Cache key prefix (to avoid conflicts with other apps)
CACHE_PREFIX=myapi:cache

# Default cache TTL in seconds (5 minutes)
CACHE_DEFAULT_TTL=300


# =============================================================================
# RATE LIMITER CONFIGURATION (Redis)
# =============================================================================

# Enable rate limiting (requires Redis)
LIMITER_ENABLED=False

# Redis host for rate limiter
LIMITER_REDIS_HOST=localhost

# Redis port for rate limiter
LIMITER_REDIS_PORT=6379

# Redis password for rate limiter (leave empty if no password)
LIMITER_REDIS_PASSWORD=

# Redis database number for rate limiter (use different from cache)
LIMITER_REDIS_DB=1

# Rate limiter key prefix
LIMITER_PREFIX=myapi:limiter

# Default rate limit: number of requests
LIMITER_DEFAULT_TIMES=100

# Default rate limit: time window in seconds
LIMITER_DEFAULT_SECONDS=60


# =============================================================================
# WINDX CONFIGURATOR CONFIGURATION
# =============================================================================

# Formula Evaluation Safety Settings
# -----------------------------------

# Maximum length for price/weight formulas (characters)
# Prevents excessively complex formulas that could impact performance
WINDX_FORMULA_MAX_LENGTH=500

# Maximum execution time for formula evaluation (seconds)
# Timeout to prevent infinite loops or slow formulas
WINDX_FORMULA_TIMEOUT_SECONDS=5

# Allowed mathematical functions in formulas (comma-separated)
# Only these functions can be used in price/weight formulas for security
# Available: abs, min, max, round, ceil, floor, sqrt, pow
WINDX_FORMULA_ALLOWED_FUNCTIONS=abs,min,max,round,ceil,floor,sqrt,pow

# Maximum number of variables allowed in a single formula
# Prevents overly complex formulas with too many dependencies
WINDX_FORMULA_MAX_VARIABLES=20


# Snapshot Retention Policy Settings
# -----------------------------------

# Number of days to retain configuration snapshots
# Snapshots older than this will be eligible for cleanup
# Minimum: 30 days, Maximum: 3650 days (10 years)
WINDX_SNAPSHOT_RETENTION_DAYS=365

# Enable automatic cleanup of old snapshots
# When enabled, snapshots older than retention period are automatically deleted
WINDX_SNAPSHOT_AUTO_CLEANUP=True


# Template Usage Tracking Settings
# ---------------------------------

# Enable template usage tracking and analytics
# Tracks which templates are used and their conversion rates
WINDX_TEMPLATE_TRACK_USAGE=True

# Minimum success rate percentage for template recommendations (0-100)
# Templates below this threshold won't be recommended to users
WINDX_TEMPLATE_SUCCESS_THRESHOLD=20

# Number of templates to show in "popular templates" list
# Controls how many top templates are displayed
WINDX_TEMPLATE_POPULAR_LIMIT=10


# Calculation Precision Settings
# -------------------------------

# Decimal places for price calculations
# Controls rounding precision for all price calculations
WINDX_PRICE_CALCULATION_PRECISION=2

# Decimal places for weight calculations
# Controls rounding precision for all weight calculations
WINDX_WEIGHT_CALCULATION_PRECISION=2
