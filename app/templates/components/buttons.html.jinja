{#
  Professional Button Component Macro
  
  A comprehensive button component that follows the WindX design system
  with support for various styles, states, and accessibility features.
  
  Usage Examples:
    {{ button("Save Changes", type="submit", variant="primary") }}
    {{ button("Cancel", href="/back", variant="outline") }}
    {{ button("Delete", onclick="confirmDelete()", variant="danger", icon="fas fa-trash") }}
    {{ button("Loading...", variant="primary", loading=true, disabled=true) }}
    {{ button("Icon Only", variant="ghost", icon="fas fa-cog", icon_only=true, title="Settings") }}
#}

{% macro button(
    text="Button",
    type="button",
    variant="primary",
    size="md",
    href=None,
    onclick=None,
    disabled=false,
    loading=false,
    icon=None,
    icon_position="left",
    icon_only=false,
    class="",
    style="",
    id="",
    title="",
    target="_self",
    form=None,
    alpine_attrs="",
    data_attrs="",
    aria_label=""
) %}

{%- set base_classes = "btn btn-" + size + " btn-" + variant -%}
{%- if variant == "tab" -%}
  {%- set base_classes = "btn btn-tab" -%}
{%- endif -%}
{%- set all_classes = [base_classes, class] | join(" ") | trim -%}
{%- set button_title = title or (text if icon_only else "") -%}
{%- set button_aria_label = aria_label or (text if icon_only else "") -%}

{%- if href -%}
  <a href="{{ href }}"
     {% if id %}id="{{ id }}"{% endif %}
     class="{{ all_classes }}"
     {% if style %}style="{{ style }}"{% endif %}
     {% if button_title %}title="{{ button_title }}"{% endif %}
     {% if button_aria_label %}aria-label="{{ button_aria_label }}"{% endif %}
     {% if target != "_self" %}target="{{ target }}"{% endif %}
     {% if disabled %}aria-disabled="true" tabindex="-1"{% endif %}
     {{ alpine_attrs | safe }}
     {{ data_attrs | safe }}>
    
    {%- if loading -%}
      <svg class="btn-spinner" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
    {%- elif icon and (icon_position == "left" or icon_only) -%}
      <i class="{{ icon }} {% if not icon_only %}btn-icon-left{% endif %}"></i>
    {%- endif -%}
    
    {%- if not icon_only -%}
      <span class="btn-text">{{ text }}</span>
    {%- endif -%}
    
    {%- if icon and icon_position == "right" and not icon_only and not loading -%}
      <i class="{{ icon }} btn-icon-right"></i>
    {%- endif -%}
  </a>
{%- else -%}
  <button type="{{ type }}"
          {% if id %}id="{{ id }}"{% endif %}
          class="{{ all_classes }}"
          {% if style %}style="{{ style }}"{% endif %}
          {% if button_title %}title="{{ button_title }}"{% endif %}
          {% if button_aria_label %}aria-label="{{ button_aria_label }}"{% endif %}
          {% if disabled or loading %}disabled{% endif %}
          {% if onclick %}onclick="{{ onclick }}"{% endif %}
          {% if form %}form="{{ form }}"{% endif %}
          {{ alpine_attrs | safe }}
          {{ data_attrs | safe }}>
    
    {%- if loading -%}
      <svg class="btn-spinner" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
    {%- elif icon and (icon_position == "left" or icon_only) -%}
      <i class="{{ icon }} {% if not icon_only %}btn-icon-left{% endif %}"></i>
    {%- endif -%}
    
    {%- if not icon_only -%}
      <span class="btn-text">{{ text }}</span>
    {%- endif -%}
    
    {%- if icon and icon_position == "right" and not icon_only and not loading -%}
      <i class="{{ icon }} btn-icon-right"></i>
    {%- endif -%}
  </button>
{%- endif -%}

{% endmacro %}

{#
  Button Group Macro
  
  Creates a group of buttons with proper spacing and alignment.
  
  Usage:
    {% call button_group(align="right", gap="sm") %}
      {{ button("Cancel", variant="outline") }}
      {{ button("Save", variant="primary") }}
    {% endcall %}
#}
{% macro button_group(align="left", gap="md", class="", style="") %}
  <div class="btn-group btn-group-{{ align }} btn-group-gap-{{ gap }} {{ class }}"
       {% if style %}style="{{ style }}"{% endif %}>
    {{ caller() }}
  </div>
{% endmacro %}

{#
  Floating Action Button Macro
  
  Creates a floating action button for primary actions.
  
  Usage:
    {{ fab("Add New", icon="fas fa-plus", onclick="openModal()") }}
#}
{% macro fab(text, icon="fas fa-plus", onclick=None, href=None, position="bottom-right", class="", style="") %}
  {%- set fab_classes = "btn-fab btn-fab-" + position -%}
  {%- set all_classes = [fab_classes, class] | join(" ") | trim -%}
  
  {%- if href -%}
    <a href="{{ href }}" class="{{ all_classes }}" {% if style %}style="{{ style }}"{% endif %} title="{{ text }}">
      <i class="{{ icon }}"></i>
      <span class="btn-fab-text">{{ text }}</span>
    </a>
  {%- else -%}
    <button type="button" class="{{ all_classes }}" {% if style %}style="{{ style }}"{% endif %} 
            {% if onclick %}onclick="{{ onclick }}"{% endif %} title="{{ text }}">
      <i class="{{ icon }}"></i>
      <span class="btn-fab-text">{{ text }}</span>
    </button>
  {%- endif -%}
{% endmacro %}