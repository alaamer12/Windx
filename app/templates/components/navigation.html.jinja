{# Navigation Components - RBAC-aware navigation elements #}

{% import "components/rbac_helpers.html.jinja" as rbac with context %}

{# 
  RBAC Sidebar Macro
  Renders the admin sidebar with automatic RBAC filtering of menu items
  
  Parameters:
    - active_page: String indicating which page is currently active
  
  Usage:
    {{ rbac_sidebar(active_page="dashboard") }}
#}
{% macro rbac_sidebar(active_page=None) %}
  <aside class="sidebar">
    <div class="sidebar-header">
      <a href="/api/v1/admin/dashboard" class="logo">WindX Admin</a>
    </div>
    
    <nav class="sidebar-nav">
      {{ rbac.rbac_nav_item(
        'Dashboard',
        '/api/v1/admin/dashboard',
        active=(active_page == 'dashboard'),
        icon='ğŸ“Š'
      ) }}
      
      {{ rbac.rbac_nav_item(
        'Manufacturing Types',
        '/api/v1/admin/manufacturing-types',
        permission='manufacturing_type:read',
        active=(active_page == 'manufacturing'),
        icon='ğŸ­'
      ) }}
      
      {{ rbac.rbac_nav_item(
        'Hierarchy Editor',
        '/api/v1/admin/hierarchy',
        permission='attribute_node:read',
        active=(active_page == 'hierarchy'),
        icon='ğŸŒ³'
      ) }}
      
      {# Customers - conditionally enabled #}
      {% if enable_customers %}
        {{ rbac.rbac_nav_item(
          'Customers',
          '/api/v1/admin/customers',
          permission='customer:read',
          active=(active_page == 'customers'),
          icon='ğŸ‘¥',
          badge='Beta'
        ) }}
      {% else %}
        {{ rbac.rbac_nav_item(
          'Customers',
          '#',
          permission='customer:read',
          icon='ğŸ‘¥',
          badge='Soon',
          disabled=True
        ) }}
      {% endif %}
      
      {# Orders - conditionally enabled #}
      {% if enable_orders %}
        {{ rbac.rbac_nav_item(
          'Orders',
          '/api/v1/admin/orders',
          permission='order:read',
          active=(active_page == 'orders'),
          icon='ğŸ“¦',
          badge='Beta'
        ) }}
      {% else %}
        {{ rbac.rbac_nav_item(
          'Orders',
          '#',
          permission='order:read',
          icon='ğŸ“¦',
          badge='Soon',
          disabled=True
        ) }}
      {% endif %}
      
      {{ rbac.rbac_nav_item(
        'Settings',
        '/api/v1/admin/settings',
        role='SUPERADMIN',
        active=(active_page == 'settings'),
        icon='âš™ï¸'
      ) }}
      
      {{ rbac.rbac_nav_item(
        'Documentation',
        '/api/v1/admin/documentation',
        active=(active_page == 'documentation'),
        icon='ğŸ“š'
      ) }}
    </nav>
    
    <div class="sidebar-footer">
      <div class="user-info">
        <span class="user-icon">ğŸ‘¤</span>
        <span class="user-name">{{ current_user.username if current_user else 'Admin' }}</span>
      </div>
      <a href="/api/v1/admin/logout" class="logout-btn">Logout</a>
    </div>
  </aside>
{% endmacro %}

{# 
  RBAC Navbar Macro
  Renders the top navigation bar with user context
  
  Parameters:
    None - uses current_user from context
  
  Usage:
    {{ rbac_navbar() }}
#}
{% macro rbac_navbar() %}
  <nav class="navbar">
    <div class="navbar-brand">
      <a href="/api/v1/admin/dashboard" class="logo">WindX Admin</a>
    </div>
    <div class="navbar-user">
      <span class="user-icon">ğŸ‘¤</span>
      <span class="user-name">{{ current_user.username if current_user else 'Admin' }}</span>
    </div>
  </nav>
{% endmacro %}
