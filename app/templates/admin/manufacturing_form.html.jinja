{% extends "admin/base.html.jinja" %}
{% from "components/buttons.html.jinja" import button, button_group with context %}

{% block title %}{{ action }} Manufacturing Type - WindX Admin{% endblock %}

{% set active_page = "manufacturing" %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">{{ action }} Manufacturing Type</h1>
    {{ button(
        text="‚Üê Back to List",
        href="/api/v1/admin/manufacturing-types",
        variant="outline"
    ) }}
</div>

<div class="card" style="max-width: 800px; margin: 0 auto;">
    <form method="POST">
        <div class="form-group">
            <label for="name" class="form-label">Name</label>
            <input type="text" id="name" name="name" class="form-control" 
                   value="{{ form_data.name if form_data else (mfg_type.name if mfg_type else '') }}" required>
            <small style="color: var(--text-light);">e.g., "Casement Window", "Entry Door"</small>
        </div>

        <div class="form-group">
            <label for="base_category" class="form-label">Category</label>
            <input type="text" id="base_category" name="base_category" class="form-control" 
                   value="{{ form_data.base_category if form_data else (mfg_type.base_category if mfg_type else '') }}">
            <small style="color: var(--text-light);">e.g., "window", "door", "furniture"</small>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div class="form-group">
                <label for="base_price" class="form-label">Base Price ($)</label>
                <input type="number" step="0.01" id="base_price" name="base_price" class="form-control" 
                       value="{{ form_data.base_price if form_data else (mfg_type.base_price if mfg_type else '0.00') }}" required>
            </div>

            <div class="form-group">
                <label for="base_weight" class="form-label">Base Weight (kg)</label>
                <input type="number" step="0.01" id="base_weight" name="base_weight" class="form-control" 
                       value="{{ form_data.base_weight if form_data else (mfg_type.base_weight if mfg_type else '0.00') }}" required>
            </div>
        </div>

        <div class="form-group">
            <label for="description" class="form-label">Description</label>
            <textarea id="description" name="description" class="form-control" rows="3">{{ form_data.description if form_data else (mfg_type.description if mfg_type else '') }}</textarea>
        </div>

        <div class="form-group" style="display: flex; align-items: center; gap: 0.5rem;">
            <input type="checkbox" id="is_active" name="is_active" value="true" 
                   {% if (form_data and form_data.is_active) or (mfg_type and mfg_type.is_active) or (not mfg_type and not form_data) %}checked{% endif %}>
            <label for="is_active" class="form-label" style="margin-bottom: 0;">Active</label>
        </div>

        {% call button_group(align="right", gap="md", style="margin-top: 2rem;") %}
            {{ button(
                text="Cancel",
                href="/api/v1/admin/manufacturing-types",
                variant="outline"
            ) }}
            {{ button(
                text="üíæ " + action + " Type",
                type="submit",
                variant="primary"
            ) }}
        {% endcall %}
    </form>
</div>

{% if action == 'Edit' %}
<div class="card" style="max-width: 800px; margin: 2rem auto 0; border-color: #fecaca;">
    <h3 style="color: #991b1b; margin-bottom: 1rem;">‚ö†Ô∏è Danger Zone</h3>
    <p style="margin-bottom: 1rem;">Deleting this manufacturing type will also delete all associated attribute hierarchies and configurations.</p>
    <form method="POST" action="/api/v1/admin/manufacturing-types/{{ mfg_type.id }}/delete" onsubmit="return confirm('Are you sure? This action cannot be undone.');">
        {{ button(
            text="üóëÔ∏è Delete Manufacturing Type",
            type="submit",
            variant="danger"
        ) }}
    </form>
</div>
{% endif %}
{% endblock %}
